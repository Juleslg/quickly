<div class="{% unless section.settings.remove_vertical_spacing %}section-spacing{% endunless %}" {% if section.settings.allow_transparent_header %}allow-transparent-header{% endif %}>
    <image-with-text-overlay class="content-over-media content-over-media--{{ section.settings.image_size }}" reveal-on-scroll="{{ section.settings.reveal_on_scroll }}">
      {% if section.settings.image != blank %}
        <picture>
          {% if section.settings.mobile_image != blank %}
            <source
              media="(max-width: 699px)"
              srcset="{{ section.settings.mobile_image | image_url: width: '400x' }} 400w, {{ section.settings.mobile_image | image_url: width: '600x' }} 600w, {{ section.settings.mobile_image | image_url: width: '800x' }} 800w, {{ section.settings.mobile_image | image_url: width: '1000x' }} 1000w"
              width="{{ section.settings.mobile_image.width }}"
              height="{{ section.settings.mobile_image.height }}"
            >
          {% endif %}
          {{ section.settings.image | image_url: width: section.settings.image.width | image_tag: loading: 'lazy', sizes: '100vw', widths: '200,300,400,500,600,700,800,900,1000,1200,1400,1600,1800,2000,2200,2400,2600,2800,3000,3200' }}
        </picture>
      {% else %}
        {{ 'lifestyle-1' | placeholder_svg_tag: 'placeholder' | replace: '<svg', '<svg preserveAspectRatio="xMinYMin slice"' }}
      {% endif %}
  
      {% if section.blocks.size > 0 %}
        <div class="content {{ section.settings.mobile_text_position }} {{ section.settings.desktop_text_position }}" style="{% render 'surface', text_color: section.settings.text_color %}">
          <div class="prose">
            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'subheading' %}
                  {% if block.settings.text != blank %}
                    <p class="h6" {{ block.shopify_attributes }}>{{ block.settings.text }}</p>
                  {% endif %}
                {% when 'heading' %}
                  {% if block.settings.text != blank %}
                    <p class="{{ block.settings.heading_tag }}" {{ block.shopify_attributes }}>{{ block.settings.text }}</p>
                  {% endif %}
                {% when 'richtext' %}
                  {% if block.settings.content != blank %}
                    <div {{ block.shopify_attributes }}>
                      {{ block.settings.content }}
                    </div>
                  {% endif %}
                {% when 'liquid' %}
                  {% if block.settings.liquid != blank %}
                    <div {{ block.shopify_attributes }}>
                      {{ block.settings.liquid }}
                    </div>
                  {% endif %}
                {% when 'button' %}
                  {% if block.settings.text != blank %}
                    {% render 'button', content: block.settings.text, href: block.settings.url, style: block.settings.style, background: block.settings.background, text_color: block.settings.text_color, block: block %}
                  {% endif %}
                {% when 'link' %}
                  {% if block.settings.text != blank %}
                    <div {{ block.shopify_attributes }}>
                      <a href="{{ block.settings.url }}">{{ block.settings.text }}</a>
                    </div>
                  {% endif %}
                {% when 'hotspot' %}
                    <div class="hotspot" style="--hotspot-x: {{ block.settings.x_axis }}; --hotspot-y: {{ block.settings.y_axis }};">
                        +
                        <div class="hotspot-content">{{ block.settings.product.title }}</div>
              {% endcase %}
            {% endfor %}
          </div>
        </div>
      {% endif %}
    </image-with-text-overlay>
  </div>
  
  

  <style>
  #shopify-section-{{ section.id }} {
    {% if section.settings.overlay_color != 'rgba(0,0,0,0)' %}
      --content-over-media-overlay: {{ section.settings.overlay_color.rgb }} / {{ section.settings.overlay_opacity | divided_by: 100.0 }};
    {% endif %}
    --content-over-media-content-max-width: var(--container-{{ section.settings.content_width }}-max-width);
  }
  .hotspot {
    position: absolute;
    font-size: 44px;
    color: black;
    cursor: pointer;
    transform: translate(calc((var(--hotspot-x) - 50) * 4%), calc((var(--hotspot-y) - 50) * 4%));
  }

  .hotspot:hover .hotspot-content {
    display: block;
  }
  .hotspot-content {
    display: none;
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: #000;
    color: #fff;
    padding: 5px;
    border-radius: 3px;
    white-space: nowrap;
  }
</style>



{% schema %}
    {
        "name": "Image with Text Overlay",
        "class": "shopify-section--image-with-text-overlay",
        "tag": "section",
        "max_blocks": 10,
        "disabled_on": {
          "groups": ["header", "custom.overlay"]
        },
        "settings": [
          {
            "type": "select",
            "id": "image_size",
            "label": "Image Size",
            "options": [
              {"value": "auto", "label": "Original Image Ratio"},
              {"value": "xs", "label": "Extra Small"},
              {"value": "sm", "label": "Small"},
              {"value": "md", "label": "Medium"},
              {"value": "lg", "label": "Large"},
              {"value": "fill", "label": "Fit to Screen"}
            ],
            "default": "auto"
          },
          {
            "type": "image_picker",
            "id": "image",
            "label": "Desktop Image"
          },
          {
            "type": "image_picker",
            "id": "mobile_image",
            "label": "Mobile Image"
          },
          {
            "type": "checkbox",
            "id": "allow_transparent_header",
            "label": "Allow Transparent Header",
            "default": false
          },
          {
            "type": "checkbox",
            "id": "reveal_on_scroll",
            "label": "Reveal on Scroll",
            "default": true
          },
          {
            "type": "checkbox",
            "id": "remove_vertical_spacing",
            "label": "Remove Vertical Spacing",
            "default": true
          },
          {
            "type": "select",
            "id": "content_width",
            "label": "Content Width",
            "options": [
              {"value": "xs", "label": "Extra Small"},
              {"value": "sm", "label": "Small"},
              {"value": "md", "label": "Medium"},
              {"value": "lg", "label": "Large"},
              {"value": "xl", "label": "Extra Large"}
            ],
            "default": "md"
          },
          {
            "type": "select",
            "id": "mobile_text_position",
            "label": "Mobile Text Position",
            "options": [
              {"value": "top-left", "label": "Top Left"},
              {"value": "top-center", "label": "Top Center"},
              {"value": "top-right", "label": "Top Right"},
              {"value": "middle-left", "label": "Middle Left"},
              {"value": "middle-center", "label": "Middle Center"},
              {"value": "middle-right", "label": "Middle Right"},
              {"value": "bottom-left", "label": "Bottom Left"},
              {"value": "bottom-center", "label": "Bottom Center"},
              {"value": "bottom-right", "label": "Bottom Right"}
            ],
            "default": "middle-center"
          },
          {
            "type": "select",
            "id": "desktop_text_position",
            "label": "Desktop Text Position",
            "options": [
              {"value": "top-left", "label": "Top Left"},
              {"value": "top-center", "label": "Top Center"},
              {"value": "top-right", "label": "Top Right"},
              {"value": "middle-left", "label": "Middle Left"},
              {"value": "middle-center", "label": "Middle Center"},
              {"value": "middle-right", "label": "Middle Right"},
              {"value": "bottom-left", "label": "Bottom Left"},
              {"value": "bottom-center", "label": "Bottom Center"},
              {"value": "bottom-right", "label": "Bottom Right"}
            ],
            "default": "middle-center"
          },
          {
            "type": "color",
            "id": "text_color",
            "label": "Text Color",
            "default": "#ffffff"
          },
          {
            "type": "color",
            "id": "overlay_color",
            "label": "Overlay Color",
            "default": "#000000"
          },
          {
            "type": "range",
            "id": "overlay_opacity",
            "label": "Overlay Opacity",
            "min": 0,
            "max": 100,
            "step": 1,
            "unit": "%",
            "default": 30
          }
        ],
        "blocks": [
          {
            "type": "subheading",
            "name": "Subheading",
            "settings": [
              {
                "type": "inline_richtext",
                "id": "text",
                "label": "Text",
                "default": "Subheading"
              }
            ]
          },
          {
            "type": "heading",
            "name": "Heading",
            "settings": [
              {
                "type": "inline_richtext",
                "id": "text",
                "label": "Text",
                "default": "Heading"
              },
              {
                "type": "select",
                "id": "heading_tag",
                "label": "Heading Tag",
                "options": [
                  {"value": "h1", "label": "H1"},
                  {"value": "h2", "label": "H2"},
                  {"value": "h3", "label": "H3"},
                  {"value": "h4", "label": "H4"},
                  {"value": "h5", "label": "H5"},
                  {"value": "h6", "label": "H6"}
                ],
                "default": "h4"
              }
            ]
          },
          {
            "type": "richtext",
            "name": "Rich Text",
            "settings": [
              {
                "type": "richtext",
                "id": "content",
                "label": "Content",
                "default": "<p>Use this text to share information about your brand with your customers. Describe a product, share announcements, or welcome customers to your store.</p>"
              }
            ]
          },
          {
            "type": "liquid",
            "name": "Custom Liquid",
            "settings": [
              {
                "type": "liquid",
                "id": "liquid",
                "label": "Liquid Code",
                "default": "<p>Use this text to output some custom Liquid code to include widget or dynamic code.</p>"
              }
            ]
          },
          {
            "type": "button",
            "name": "Button",
            "settings": [
              {
                "type": "select",
                "id": "style",
                "label": "Style",
                "options": [
                  {"value": "outline", "label": "Outline"},
                  {"value": "solid", "label": "Solid"}
                ],
                "default": "solid"
              },
              {
                "type": "text",
                "id": "text",
                "label": "Button Text",
                "default": "Button text"
              },
              {
                "type": "url",
                "id": "url",
                "label": "URL",
                "default": ""
              },
              {
                "type": "color",
                "id": "background",
                "label": "Background Color"
              },
              {
                "type": "color",
                "id": "text_color",
                "label": "Text Color"
              }
            ]
          },
          {
            "type": "link",
            "name": "Link",
            "settings": [
              {
                "type": "text",
                "id": "text",
                "label": "Link Text",
                "default": "Link text"
              },
              {
                "type": "url",
                "id": "url",
                "label": "URL",
                "default": ""
              }
            ]
          }
        ],
        "presets": [
          {
            "name": "Default",
            "category": "Image with Text Overlay",
            "settings": {
              "image_size": "auto",
              "text_color": "#ffffff",
              "overlay_color": "#000000",
              "overlay_opacity": 30
            },
            "blocks": [
              {
                "type": "heading",
                "settings": {
                  "text": "Image with Text Overlay"
                }
              },
              {
                "type": "richtext",
                "settings": {
                  "content": "<p>Add your own custom content to give more information about your store, availability details...</p>"
                }
              }
            ]
          }
        ]
    }
    {% endschema %}
    
  